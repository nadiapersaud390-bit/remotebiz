/**
 * ROZITA ARCHITECTURE V2.6 - REMOTE FORCE 6 (FIXED 400)
 * Specifically designed for the 6 agents shown in your image.
 */

function doGet() {
  try {
    const ss = SpreadsheetApp.getActiveSpreadsheet();
    // Tab must be named "Remote"
    const sheet = ss.getSheetByName("Remote"); 
    
    if (!sheet) {
      return createJsonResponse({ 
        error: "Sheet tab 'Remote' not found. Create a tab named Remote." 
      });
    }
    
    // We fetch the first 6 agents (Rows 2 to 7)
    const dataRange = sheet.getRange(2, 1, 6, 2);
    const values = dataRange.getValues();
    
    const data = values.map(row => {
      return {
        name: row[0] ? row[0].toString().trim() : "Empty Slot",
        leads: parseInt(row[1]) || 0
      };
    }).filter(agent => agent.name !== "Empty Slot");
    
    return createJsonResponse(data);

  } catch (e) {
    return createJsonResponse({ error: "Script Error: " + e.toString() });
  }
}

function createJsonResponse(data) {
  return ContentService.createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}
